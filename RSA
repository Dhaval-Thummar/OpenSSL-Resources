# ------------------- RSA -------------------

# To generate private key
openssl genrsa

# Manage RSA private key, includes generating a public key
openssl rsa

# Encrypt and decrypt files with RSA keys
openssl rsautl

# To generate private key (n, d) using RSA
1. openssl genrsa -out private.pem 4096
2. openssl genpkey -algorithm RSA -out private.pem -pkeyopt rsa_keygen_bits:2048
3. openssl genpkey -algorithm RSA -pkeyopt rsa_keygen_bits:2048 -pkeyopt rsa_keygen_pubexp:3 -out private.pem

# Format of RSA private key (RFC 3447)
  RSAPrivateKey ::= SEQUENCE {
      version           Version,
      modulus           INTEGER,  -- n
      publicExponent    INTEGER,  -- e
      privateExponent   INTEGER,  -- d
      prime1            INTEGER,  -- p
      prime2            INTEGER,  -- q
      exponent1         INTEGER,  -- d mod (p-1)
      exponent2         INTEGER,  -- d mod (q-1)
      coefficient       INTEGER,  -- (inverse of q) mod p
      otherPrimeInfos   OtherPrimeInfos OPTIONAL
  }

# To dispaly the above details of a private key in RSA
1. openssl rsa -text -in private.pem
2. openssl rsa -text -in private.pem -noout
3. openssl pkey -in private.pem -text

# To display only the private key
cat private.pem

# To generate encrypted private key using RSA
1. openssl genrsa -des3 -out private.pem 2048
2. openssl genrsa -aes128 -passout pass:<phrase> -out private.pem 4096

# To encrypt private key
1. openssl rsa -des3 -in private.pem -out enc-private.pem

# To generate public key (n, e) from private key in RSA
1. openssl rsa -in private.pem -pubout -out public.pem
2. openssl rsa -in private.pem -pubout -out public.pem -outform PEM
3. openssl rsa -in private.pem -pubout > public.pem
4. openssl pkey -in private.pem -out public.pem -pubout

# To seperate public key form encrypted private key in RSA
openssl rsa -in private.pem -passin pass:<phrase> -pubout -out public.pem

# To display (n, e) of a public key
1. openssl rsa -text -in public.pem -pubin 
2. openssl pkey -in public.pem -pubin -text

# To check private and public key files
1. less public.pem
2. less private.pem

# Encryption in RSA (uses public key of receiver only) ("-pubin" if public.pem contains only public key)
1. openssl rsautl -encrypt -inkey public.pem -pubin -in input.txt -out cipher.bin
2. openssl pkeyutl -encrypt -in message.txt -pubin -inkey public.pem -out cipher.bin

# Encryption in RSA (uses public key of receiver only) (no "-pubin", since private key file private.pem contains public key)
openssl rsautl -encrypt -inkey private.pem -in input.txt -out <output_file> 

# Decryption in RSA (uses private key of receiver only)
1. openssl rsautl -decrypt -inkey private.pem -in cipher.bin -out decrypted.txt
2. openssl pkeyutl -decrypt -in cipher.bin -inkey private.pem -out received-ID.txt
